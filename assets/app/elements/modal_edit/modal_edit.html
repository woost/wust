<div class="modal_edit modal">
    <form class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <div ng-if="::uiSettings.surveyEnabled" style="position:relative; height: 55px;">
                    <div survey can-hide="true" style="width: 100% !important"></div>
                </div>
                <span class="response-header" ng-if="vm.node.referenceNode">
                    <h2>Respond to</h2>
                    <span small-post node="vm.node.referenceNode" class="disable-link reference-node"></span>
                </span>
                <span ng-if="vm.node.isLocal && !vm.node.referenceNode">
                    <h2 class="text-center">Start Discussion</h2>
                </span>
            </div>
            <div class="modal-body" colored-tag-node="vm.node" big="true">
                <div new-post node="vm.node" input-focus="true" preview-enabled="vm.previewEnabled"></div>
            </div>
            <div class="modal-footer">
                <progressbar ng-if="vm.editedComponentNode" max="vm.editedComponentNode.postChangeThreshold" type="success" value="vm.editWeight" class="karma-progress">
                    <span style="white-space:nowrap; padding-left: 5px;" ng-switch="vm.canApply">
                        <span ng-switch-when="true">You have enough Karma. This change will be applied instantly.</span>
                        <span ng-switch-default>This will become a change request, starting with {{vm.editWeight}} of {{vm.editedComponentNode.postChangeThreshold}} Votes.</span>
                    </span>
                </progressbar>
                <button class="pull-left btn btn-sm btn-danger" ng-click="vm.node.deleteNode(); $hide()" ng-hide="vm.node.isLocal" title="Delete"><i class="fa fa-trash-o"></i></button>
                <button class="btn btn-default" ng-click="$hide()">Cancel</button>
                <button class="btn btn-default" type="submit" ng-click="vm.save()" ng-disabled="vm.node.isSaving || (!vm.node.isLocal && vm.node.isPristine)">
                    <span ng-if="::vm.node.newDiscussion">Start Discussion</span>
                    <span ng-if="::!vm.node.newDiscussion && vm.node.isLocal">Respond</span>
                    <span ng-if="::vm.node.isEdit">Save</span>
                </button>
            </div>
        </div>
    </form>
</div>
